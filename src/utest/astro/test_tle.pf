module test_tle
  use pfunit_mod
  use trncmp_ENV
  use tle_mod
  implicit none

  character(80), parameter :: TEST_CARDS(3,8) = reshape( [ &
       &  '0 GALAXY 11                                                                     ',  &
       &  '1 26038U 99071A   20051.59559404 -.00000181  00000-0  00000+0 0  9994           ',  &
       &  '2 26038   0.9362  98.4299 0000381 330.7079 202.1395  1.00272446 73922           ',  &
       &  '0 INTELSAT 1R (PAS 1R)                                                          ',  &
       &  '1 26608U 00072A   20051.71728817 -.00000157  00000-0  00000+0 0  9993           ',  &
       &  '2 26608   2.4519  86.8910 0000401 311.5656 166.9708  1.00271677 70509           ',  &
       &  '0 XM-3                                                                          ',  &
       &  '1 28626U 05008A   20051.48313236 -.00000223  00000-0  00000+0 0  9992           ',  &
       &  '2 28626   0.0146 117.6268 0000370 329.7318 151.3278  1.00267991 54912           ',  &
       &  '0 SPACEWAY 1                                                                    ',  &
       &  '1 28644U 05015A   20051.56549764 -.00000138 +00000-0 +00000-0 0  9992           ',  &
       &  '2 28644 000.8325 094.6628 0000986 339.2814 035.4310 00.98490233023449           ',  &
       &  '0 SPACEWAY 2                                                                    ',  &
       &  '1 28903U 05046B   20051.03035433 -.00000145  00000-0  00000+0 0  9996           ',  &
       &  '2 28903   0.0061  94.0600 0000227  33.5692 293.6300  1.00274275 52344           ',  &
       &  '0 XM-4                                                                          ',  &
       &  '1 29520U 06049A   20051.29733904 -.00000040 +00000-0 +00000-0 0  9997           ',  &
       &  '2 29520 000.0025 096.6470 0000404 327.8280 076.9409 01.00271763028324           ',  &
       &  '0 SPACEWAY 3                                                                    ',  &
       &  '1 32018U 07036A   20051.79271690 -.00000170  00000-0  00000+0 0  9997           ',  &
       &  '2 32018   0.0127 116.2133 0000536 333.3249 251.0786  1.00272316 45981           ',  &
       &  '0 AMAZONAS 4A                                                                   ',  &
       &  '1 39616U 14011A   20051.52763726 -.00000271  00000-0  00000+0 0  9998           ',  &
       &  '2 39616   0.0582  70.9974 0002550 275.0324 279.8171  1.00269528 21712           '   &
       & ], [3,8] )

contains

  @test
  !/ =====================================================================================
  subroutine test_tle_parse
    !/ -----------------------------------------------------------------------------------
    use file_tools
    implicit none
    

    type(TCard) :: T

    integer :: i, j, un

    character(80) :: crd0, crd1, crd2

    un = WriteUnit( FILE='/tmp/x2' )

    
   
    do j=1,8
       call T%set( CARD0=TEST_CARDS(1,j), CARD1=TEST_CARDS(2,j), CARD2=TEST_CARDS(3,j) )
       call T%get( CARD0=crd0, CARD1=crd1, CARD2=crd2 )
       write(un,100) trim(adjustl(crd0))
       write(un,100) trim(adjustl(crd1))
       write(un,100) trim(adjustl(crd2))
    end do

    close(un)

100 format( A )
    
  end subroutine test_tle_parse  

end module test_tle
